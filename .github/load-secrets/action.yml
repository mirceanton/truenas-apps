---
name: Load Secrets from 1Password
description: Load secrets from 1Password and export them as environment variables

inputs:
  op-connect-host:
    description: 1Password Connect Host
    required: true
  op-connect-token:
    description: 1Password Connect Token
    required: true

runs:
  using: composite
  steps:
    - name: Configure 1Password Connect
      uses: 1password/load-secrets-action/configure@581a835fb51b8e7ec56b71cf2ffddd7e68bb25e0 # v2
      with:
        connect-host: ${{ inputs.op-connect-host }}
        connect-token: ${{ inputs.op-connect-token }}

    - name: Load secrets
      uses: 1password/load-secrets-action@8d0d610af187e78a2772c2d18d627f4c52d3fbfb # v3.1.0
      with: {export-env: true}
      env:
        AWS_ACCESS_KEY_ID: op://Automation/Mikrotik Terraform Backblaze B2 State/username
        AWS_SECRET_ACCESS_KEY: op://Automation/Mikrotik Terraform Backblaze B2 State/password

        MIKROTIK_USERNAME: op://Automation/Mikrotik/username
        MIKROTIK_PASSWORD: op://Automation/Mikrotik/password

        PPPOE_USERNAME: op://Badoink/Digi PPPoE/username
        PPPOE_PASSWORD: op://Badoink/Digi PPPoE/password
